<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Math Adventure - Decimal Division</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            background-color: #f0f9ff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .card {
            border-radius: 15px;
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.1);
            border: none;
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .btn-home {
            background-color: #ff6b6b;
            color: white;
            transition: all 0.3s;
        }

        .btn-home:hover {
            transform: scale(1.05);
        }

        .hidden {
            display: none;
        }

        .problem-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #6c5ce7;
            text-align: center;
            margin: 15px 0;
        }

        .input-step {
            width: 100px;
            border: 2px solid #4cc9f0;
            border-radius: 5px;
            padding: 5px;
            text-align: center;
        }

        .step-box {
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            margin: 15px 0;
        }

        .final-answer-box {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .correct {
            background-color: #c1fba4 !important;
        }

        .incorrect {
            background-color: #ff9aa2 !important;
        }

        .practice-step {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #6c5ce7;
        }

        .step-number {
            display: inline-block;
            background-color: #6c5ce7;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }

        .step-content {
            display: inline-block;
            vertical-align: middle;
            width: calc(100% - 50px);
        }

        .tooltip-explanation {
            font-size: 0.9rem;
            color: #555;
            margin-top: 5px;
        }

        .score-box {
            text-align: right;
            margin-bottom: 10px;
            font-weight: bold;
        }

        #summary {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <audio id="success-sound"
        src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_44ba749e2a.mp3?filename=success-1-6297.mp3"></audio>
    <div class="container mt-4">


        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
            <div class="d-flex gap-2 flex-wrap">
                <a href="index.html" class="btn btn-home">üè† Home</a>
                <a href="math_multiplication_division.html" class="btn btn-outline-primary">‚ú¥Ô∏è Decimal
                    Multiplication</a>
                <a href="division.html" class="btn btn-outline-info">‚ûó Divide with Decimals</a>
                <a href="longdivision.html" class="btn btn-outline-success">üßÆ Long Division</a>
            </div>



            <div class="card p-4">
                <h1 class="text-center" style="color: #6c5ce7;">‚ûó Decimal Division ‚ûó</h1>
                <p class="text-center">In decimal division, we divide just like whole numbers, but adjust for decimal
                    places. <br><strong>Dividend</strong> √∑ <strong>Divisor</strong> = <strong>Quotient</strong>.
                    <br>Count decimal places, convert to whole numbers, divide, then adjust decimal in the final answer.
                </p>
                <div class="text-center mb-4">
                    <h4>Choose difficulty:</h4>
                    <button class="btn btn-success m-1" id="easy-btn">Easy</button>
                    <button class="btn btn-warning m-1" id="medium-btn">Medium</button>
                    <button class="btn btn-danger m-1" id="hard-btn">Hard</button>
                </div>
                <div id="game-area" class="hidden">
                    <div class="problem-display" id="problem-text"></div>
                    <div class="step-box">
                        <h4>üß† Teacher's Example</h4>
                        <div id="teacher-steps"></div>
                    </div>
                    <div class="step-box">
                        <h4>üìù Your Turn</h4>
                        <div class="problem-display" id="student-problem"></div>
                        <div id="student-steps"></div>
                        <div class="final-answer-box" id="final-answer-box">
                            <h5>Final Answer:</h5>
                            <input type="number" step="0.01" id="user-answer" class="input-step" />
                            <button class="btn btn-success" onclick="submitFinal()">Submit</button>
                            <div id="final-feedback" class="mt-2"></div>
                        </div>
                    </div>
                    <div id="summary"></div>
                    <div class="text-center mt-3">
                        <button class="btn btn-primary hidden" id="try-again-btn" onclick="restartQuiz()">Try
                            Again</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
            let correctAnswer = 0;
            let score = 0;
            let questionCount = 0;
            let currentDifficulty = 'easy';
            const maxQuestions = 10;

            function randomDecimal(difficulty) {
                const base = difficulty === 'easy' ? 10 : difficulty === 'medium' ? 50 : 100;
                return (Math.random() * base).toFixed(1);
            }

            function setupProblem(difficulty) {
                if (questionCount >= maxQuestions) return;
                currentDifficulty = difficulty;

                const teacherDividend = randomDecimal(difficulty);
                const teacherDivisor = randomDecimal(difficulty);
                const studentDividend = randomDecimal(difficulty);
                const studentDivisor = randomDecimal(difficulty);

                correctAnswer = (parseFloat(studentDividend) / parseFloat(studentDivisor)).toFixed(2);

                const teacherStepsDiv = document.getElementById('teacher-steps');
                teacherStepsDiv.innerHTML = '';

                function createStep(num, html) {
                    return `<div class='practice-step'><div class='step-number'>${num}</div><div class='step-content'>${html}</div></div>`;
                }

                const decDiv1 = (teacherDividend.split('.')[1] || '').length;
                const decDiv2 = (teacherDivisor.split('.')[1] || '').length;
                const move = Math.max(decDiv1, decDiv2);
                const newDiv1 = parseInt(teacherDividend.replace('.', '') + '0'.repeat(move - decDiv1));
                const newDiv2 = parseInt(teacherDivisor.replace('.', '') + '0'.repeat(move - decDiv2));

                teacherStepsDiv.innerHTML += createStep(1, `Count decimal places: <strong>Dividend (${teacherDividend})</strong> has ${decDiv1} and <strong>Divisor (${teacherDivisor})</strong> has ${decDiv2}.`);
                teacherStepsDiv.innerHTML += createStep(2, `Convert to whole numbers: <strong>${teacherDividend} √∑ ${teacherDivisor}</strong> becomes <strong>${newDiv1} √∑ ${newDiv2}</strong>. Because we shift both by ${move} place(s).`);
                teacherStepsDiv.innerHTML += createStep(3, `<strong>${newDiv2}</strong> into <strong>${newDiv1}</strong>? Goes <strong>${Math.floor(newDiv1 / newDiv2)}</strong> times. Remainder: ${newDiv1 % newDiv2}.`);
                teacherStepsDiv.innerHTML += createStep(4, `Final answer is approximately <strong>${(parseFloat(teacherDividend) / parseFloat(teacherDivisor)).toFixed(2)}</strong>. We move decimal point ${move} place(s) back.`);

                document.getElementById('problem-text').textContent = `Problem: ${studentDividend} √∑ ${studentDivisor}`;
                document.getElementById('student-problem').textContent = `${studentDividend} √∑ ${studentDivisor}`;
                document.getElementById('final-answer-box').style.display = 'none';
                document.getElementById('final-feedback').innerHTML = '';
                document.getElementById('summary').innerHTML = '';
                document.getElementById('try-again-btn').classList.add('hidden');
                document.getElementById('game-area').classList.remove('hidden');

                const dec1 = (studentDividend.split('.')[1] || '').length;
                const dec2 = (studentDivisor.split('.')[1] || '').length;
                const totalMove = Math.max(dec1, dec2);
                const newDivA = parseInt(studentDividend.replace('.', '') + '0'.repeat(totalMove - dec1));
                const newDivB = parseInt(studentDivisor.replace('.', '') + '0'.repeat(totalMove - dec2));
                const approx = Math.floor(newDivA / newDivB).toString();

                const studentSteps = document.getElementById('student-steps');
                studentSteps.innerHTML = '';
                addStep(studentSteps, 'step1', `How many decimal places in divisor?`, dec2.toString());
                addStep(studentSteps, 'step2', `What is the new problem after shift?`, `${newDivA} √∑ ${newDivB}`);
                addStep(studentSteps, 'step3', `Rough result:`, approx);
                addStep(studentSteps, 'step4', `How many decimal places in final answer?`, totalMove.toString());
            }

            function addStep(container, id, question, correctVal) {
                const div = document.createElement('div');
                div.className = 'practice-step';
                div.innerHTML = `
        <div class="step-number">${id.replace('step', '')}</div>
        <div class="step-content">
          ${question}
          <input id="${id}" class="input-step" />
          <button class="btn btn-outline-primary btn-sm" onclick="checkStep('${id}', '${correctVal}')">Check</button>
          <span id="${id}-feedback"></span>
        </div>
      `;
                container.appendChild(div);
            }

            function checkStep(id, correctValue) {
                const input = document.getElementById(id);
                const feedback = document.getElementById(`${id}-feedback`);
                const sound = document.getElementById('success-sound');
                if (input.value.trim() === correctValue) {
                    feedback.innerHTML = 'üéâ <span class="correct">Correct!</span>';
                    input.classList.add('correct');
                    confetti({ particleCount: 60, spread: 45 });
                    sound.play();
                    score++;
                    document.getElementById('score').textContent = score;
                    if (id === 'step4') {
                        document.getElementById('final-answer-box').style.display = 'block';
                    }
                } else {
                    feedback.innerHTML = '‚ùå Try again';
                    input.classList.add('incorrect');
                }
            }

            function submitFinal() {
                const input = document.getElementById('user-answer');
                const feedback = document.getElementById('final-feedback');
                if (Math.abs(parseFloat(input.value) - parseFloat(correctAnswer)) < 0.01) {
                    feedback.innerHTML = '<span class="correct">üéâ Great Job!</span>';
                    confetti();
                    score++;
                    document.getElementById('score').textContent = score;
                } else {
                    feedback.innerHTML = '<span class="incorrect">Not quite. Try again!</span>';
                }
                questionCount++;
                if (questionCount >= maxQuestions) {
                    showSummary();
                } else {
                    setTimeout(() => setupProblem(currentDifficulty), 1000);
                }
            }

            function showSummary() {
                const percent = Math.round((score / (maxQuestions * 2)) * 100);
                const message = percent >= 90 ? 'üåü Excellent work!' : 'Keep practicing!';
                document.getElementById('summary').innerHTML = `You got ${percent}% correct. ${message}`;
                document.getElementById('try-again-btn').classList.remove('hidden');
            }

            function restartQuiz() {
                score = 0;
                questionCount = 0;
                document.getElementById('score').textContent = 0;
                setupProblem(currentDifficulty);
            }

            document.getElementById('easy-btn').addEventListener('click', () => { restartQuiz(); setupProblem('easy'); });
            document.getElementById('medium-btn').addEventListener('click', () => { restartQuiz(); setupProblem('medium'); });
            document.getElementById('hard-btn').addEventListener('click', () => { restartQuiz(); setupProblem('hard'); });
        </script>
</body>

</html>